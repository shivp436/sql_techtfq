-- FOR EACH ID, LIST ALL THE EMPLOYEES THAT REPORT TO THEM, INCLUDING THEMSELVES

CREATE TABLE EMP_HRC (
  EMP INT,
  MGR INT
);

INSERT INTO EMP_HRC
VALUES (1, NULL), (2, 1), (3, 1), (4, 2), (5, 2), (6, 3), (7, 3), (8, 4), (9, 4);

WITH CTE_REC AS 
(
  SELECT EMP AS MGR, EMP
  FROM EMP_HRC
  UNION ALL
  SELECT C.MGR, E.EMP AS MGR
  FROM CTE_REC AS C 
  JOIN EMP_HRC AS E ON C.EMP = E.MGR
)

SELECT * FROM CTE_REC ORDER BY MGR, EMP;




























